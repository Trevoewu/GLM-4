# RAGæ™ºèƒ½é—®ç­”ç³»ç»Ÿ

åŸºäºæœ¬åœ°çŸ¥è¯†åº“çš„æ™ºèƒ½é—®ç­”ç³»ç»Ÿï¼Œé€šè¿‡æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æŠ€æœ¯æä¾›å‡†ç¡®ã€å¯é çš„æ³•å¾‹æ³•è§„é—®ç­”æœåŠ¡ã€‚

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®ä½¿ç”¨æ¸©æ°æ³•å¾‹æ–‡æ¡£æ„å»ºçŸ¥è¯†åº“ï¼Œé€šè¿‡"é—®é¢˜-ç­”æ¡ˆ"å¯¹æ£€éªŒRAGæ•ˆæœï¼Œæœ€åé€šè¿‡Rouge-LæŒ‡æ ‡è¯„ä¼°æ¨¡å‹æ•ˆæœã€‚ç³»ç»Ÿæ”¯æŒWebç•Œé¢å’ŒèŠå¤©ç‰ˆä¸¤ç§äº¤äº’æ–¹å¼ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd rag
pip install -r requirements.txt
```

### 2. å¯åŠ¨Webæ¼”ç¤º

```bash
# å¯åŠ¨èŠå¤©ç‰ˆï¼ˆæ¨èï¼‰
python run_chat_demo.py

# æˆ–ç›´æ¥ä½¿ç”¨Streamlit
streamlit run streamlit_chat_app.py
```

### 3. è®¿é—®ç³»ç»Ÿ

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š**http://localhost:8501**

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
rag/
â”œâ”€â”€ data_processor.py      # æ•°æ®é¢„å¤„ç†æ¨¡å— - æ–‡æœ¬æŠ½å–ä¸æ¸…æ´—
â”œâ”€â”€ knowledge_base.py      # çŸ¥è¯†åº“æ„å»ºæ¨¡å— - æ–‡æ¡£å‘é‡åŒ–
â”œâ”€â”€ rag_system.py         # RAGé—®ç­”ç³»ç»Ÿ - æ£€ç´¢å¢å¼ºç”Ÿæˆ
â”œâ”€â”€ evaluator.py          # è¯„ä¼°æ¨¡å— - Rouge-LæŒ‡æ ‡è¯„ä¼°
â”œâ”€â”€ main.py              # ä¸»ç¨‹åº - æ•´åˆæ‰€æœ‰æ¨¡å—
â”œâ”€â”€ streamlit_chat_app.py # èŠå¤©ç‰ˆWebç•Œé¢
â”œâ”€â”€ run_chat_demo.py      # èŠå¤©ç‰ˆå¯åŠ¨è„šæœ¬
â”œâ”€â”€ local_llm_client.py   # æœ¬åœ°LLMå®¢æˆ·ç«¯
â”œâ”€â”€ config.py             # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt      # ä¾èµ–åŒ…
â”œâ”€â”€ README.md            # é¡¹ç›®è¯´æ˜
â””â”€â”€ dataset/             # æ•°æ®ç›®å½•
    â””â”€â”€ æ³•å¾‹æ³•è§„/         # æ³•å¾‹æ³•è§„æ–‡æ¡£
        â”œâ”€â”€ è¯ç›‘ä¼š/       # è¯ç›‘ä¼šç›¸å…³æ–‡æ¡£
        â””â”€â”€ æ·±äº¤æ‰€/       # æ·±äº¤æ‰€ç›¸å…³æ–‡æ¡£
```


## ğŸ”§ åŠŸèƒ½æ¨¡å—

### 1. æ•°æ®é¢„å¤„ç†æ¨¡å— (`data_processor.py`)

- **æ–‡æœ¬æŠ½å–**: ä»PDFå’ŒDOCXæ–‡ä»¶ä¸­æå–æ–‡æœ¬
- **æ–‡æœ¬æ¸…æ´—**: ç§»é™¤ç‰¹æ®Šå­—ç¬¦ã€é¡µçœ‰é¡µè„šç­‰
- **æ–‡æœ¬åˆ‡åˆ†**: å°†é•¿æ–‡æœ¬åˆ‡åˆ†æˆé€‚åˆå‘é‡åŒ–çš„ç‰‡æ®µ
- **é—®ç­”å¯¹ç”Ÿæˆ**: åŸºäºæ–‡æ¡£å†…å®¹åˆ›å»ºæµ‹è¯•é—®ç­”å¯¹

### 2. çŸ¥è¯†åº“æ„å»ºæ¨¡å— (`knowledge_base.py`)

- **æ–‡æ¡£å‘é‡åŒ–**: ä½¿ç”¨ä¸­æ–‡åµŒå…¥æ¨¡å‹å°†æ–‡æ¡£è½¬æ¢ä¸ºå‘é‡
- **å‘é‡å­˜å‚¨**: ä½¿ç”¨FAISSæ„å»ºé«˜æ•ˆçš„å‘é‡ç´¢å¼•
- **ç›¸ä¼¼åº¦æœç´¢**: åŸºäºå‘é‡ç›¸ä¼¼åº¦æ£€ç´¢ç›¸å…³æ–‡æ¡£

### 3. RAGé—®ç­”ç³»ç»Ÿ (`rag_system.py`)

- **æ£€ç´¢å¢å¼º**: ç»“åˆæ–‡æ¡£æ£€ç´¢å’Œè¯­è¨€æ¨¡å‹ç”Ÿæˆ
- **é—®ç­”é“¾**: ä½¿ç”¨LangChainæ„å»ºé—®ç­”æµç¨‹
- **äº¤äº’æ¨¡å¼**: æ”¯æŒç”¨æˆ·äº¤äº’å¼é—®ç­”

### 4. è¯„ä¼°æ¨¡å— (`evaluator.py`)

- **Rouge-Lè¯„ä¼°**: ä½¿ç”¨Rouge-LæŒ‡æ ‡è¯„ä¼°ç­”æ¡ˆè´¨é‡
- **æ‰¹é‡è¯„ä¼°**: æ”¯æŒæ‰¹é‡é—®ç­”å¯¹è¯„ä¼°
- **ç»“æœåˆ†æ**: æä¾›è¯¦ç»†çš„è¯„ä¼°æŠ¥å‘Š


## ğŸ› ï¸ ä½¿ç”¨æŒ‡å—

### è¿è¡Œå®Œæ•´æµç¨‹

```bash
python main.py --mode full
```

### åˆ†æ­¥è¿è¡Œ

```bash
# æ•°æ®é¢„å¤„ç†
python main.py --mode process

# çŸ¥è¯†åº“æ„å»º
python main.py --mode build

# RAGç³»ç»Ÿæµ‹è¯•
python main.py --mode rag

# è¯„ä¼°
python main.py --mode evaluate

# äº¤äº’æ¨¡å¼
python main.py --mode interactive
```

### ç®¡ç†å‘½ä»¤

```bash
# å¯åŠ¨èŠå¤©ç‰ˆæœåŠ¡
python run_chat_demo.py

# åå°è¿è¡Œ
nohup streamlit run streamlit_chat_app.py --server.port 8501 --server.address 0.0.0.0 --server.headless true > logs/streamlit_chat.log 2>&1 &

# åœæ­¢æœåŠ¡
ps aux | grep streamlit
kill <è¿›ç¨‹ID>

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/streamlit_chat.log
```


## âš™ï¸ é…ç½®è¯´æ˜

### åµŒå…¥æ¨¡å‹

é»˜è®¤ä½¿ç”¨ `shibing624/text2vec-base-chinese` ä¸­æ–‡åµŒå…¥æ¨¡å‹ï¼Œæ‚¨å¯ä»¥åœ¨ `knowledge_base.py` ä¸­ä¿®æ”¹ï¼š

```python
kb = KnowledgeBase(model_name="your_model_name")
```

### å‘é‡å­˜å‚¨

ä½¿ç”¨FAISSä½œä¸ºå‘é‡å­˜å‚¨ï¼Œæ”¯æŒé«˜æ•ˆçš„ç›¸ä¼¼åº¦æœç´¢ã€‚å‘é‡å­˜å‚¨æ–‡ä»¶ä¿å­˜åœ¨ `output/vector_store/` ç›®å½•ä¸‹ã€‚

### LLMé…ç½®

å¦‚éœ€ä½¿ç”¨OpenAI APIï¼Œè¯·åœ¨åˆå§‹åŒ–RAGç³»ç»Ÿæ—¶æä¾›APIå¯†é’¥ï¼š

```python
rag = RAGSystem(openai_api_key="your_api_key")
```

## ğŸ“ è¾“å‡ºæ–‡ä»¶

- `output/processed_documents.json`: å¤„ç†åçš„æ–‡æ¡£æ•°æ®
- `output/qa_pairs.json`: ç”Ÿæˆçš„é—®ç­”å¯¹
- `output/vector_store/`: å‘é‡å­˜å‚¨æ–‡ä»¶
- `output/evaluation_results.json`: è¯„ä¼°ç»“æœ
- `output/test_qa_pairs.json`: æµ‹è¯•é—®ç­”å¯¹

## ğŸ“Š è¯„ä¼°æŒ‡æ ‡

- **Rouge-1**: å•ä¸ªè¯æ±‡é‡å åº¦
- **Rouge-2**: åŒè¯æ±‡é‡å åº¦  
- **Rouge-L**: æœ€é•¿å…¬å…±å­åºåˆ—

